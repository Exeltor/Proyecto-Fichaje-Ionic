<ion-header>
    <ion-toolbar>
        <ion-buttons slot="start">
            <ion-menu-button></ion-menu-button>
        </ion-buttons>
        <ion-title>Fichaje</ion-title>
    </ion-toolbar>
</ion-header>

<ion-content class="ion-text-center">
    <ion-grid *ngIf="!isLoading&&locationStatus.enabled">
        <ion-row>
            <ng-container *ngIf="dayDocument | async as document; else noDayDocument">
                <ion-col size="4">
                    {{ document.horaInicio.toDate() | date:'HH:mm'}}
                </ion-col>
                <ion-col size="4">{{ timeWorked | date:'HH:mm' }}</ion-col>
                <ion-col size="4"></ion-col>
            </ng-container>
        </ion-row>
        <ion-row>
            <ion-col>
                <ion-card color="primary" *ngIf="!comenzado&&!terminado" (click)="comenzarDia()">
                    <ion-card-header>
                        <ion-card-subtitle>Accion única por día</ion-card-subtitle>
                        <ion-card-title>Comenzar dia de trabajo</ion-card-title>
                    </ion-card-header>
                    <ion-card-content>
                        Asegurate de estar en el trabajo para poder realizar esta accion
                    </ion-card-content>
                </ion-card>
                <ion-card color="warning" *ngIf="comenzado&&!enPausa&&!masPauses&&!terminado" (click)="flipPausa()">
                    <ion-card-header>
                        <ion-card-title>Descanso</ion-card-title>
                    </ion-card-header>
                </ion-card>
                <ion-card color="success" *ngIf="comenzado&&enPausa&&masPauses&&!terminado" (click)="flipPausa()">
                    <ion-card-header>
                        <ion-card-title>Volver al trabajo</ion-card-title>
                    </ion-card-header>
                </ion-card>

                <ion-card color="success" *ngIf="terminado">
                    <ion-card-header>
                        <ion-card-title>Ya has hecho todo hoy</ion-card-title>
                    </ion-card-header>
                </ion-card>
            </ion-col>
        </ion-row>
        <ion-row>
            <ion-col>
                <ion-card>
                    <ion-card-header>
                        <ion-card-subtitle>El tiempo se actualizara con cada descanso</ion-card-subtitle>
                        <ion-card-title>{{ ((fichajeService.currentWorkingData | async)?.horaTotal)?.toDate() | date:"HH:mm:ss":"+0000" }}</ion-card-title>
                    </ion-card-header>
                </ion-card>
            </ion-col>
        </ion-row>
        <ion-row>
            <ion-col>
                <ion-card color="danger" *ngIf="comenzado&&!terminado" (click)="finalizarDia()">
                    <ion-card-header>
                        <ion-card-subtitle>Accion única por día</ion-card-subtitle>
                        <ion-card-title>Finalizar dia de trabajo</ion-card-title>
                    </ion-card-header>
                    <ion-card-content>
                        Asegurate de estar en el trabajo para poder realizar esta accion
                    </ion-card-content>
                </ion-card>
            </ion-col>
        </ion-row>
    </ion-grid>
    <ion-grid *ngIf="isLoading">
        <ion-row>
            <ion-col>
                <ion-spinner></ion-spinner>
            </ion-col>
        </ion-row>
    </ion-grid>
    <ion-grid *ngIf="!locationStatus.enabled && locationStatus.deniedAlways">
        <ion-row>
            <ion-col>
                <p>Permite el uso de la localización a esta aplicación para usar la funcionalidad de fichar</p>
            </ion-col>
        </ion-row>
    </ion-grid>
</ion-content>

<ion-footer>
    <ion-toolbar>
        <ion-item slot="start" lines="none" class="ion-text-center">
            <ion-list>
                <small style="margin: 0">Precisión Localización</small>
                <ng-container *ngIf="locationAccuracy === 1">
                    <p style="margin: 0; color: green">Excelente<ion-icon name="checkmark" style="margin-left: 2px;"></ion-icon></p>
                </ng-container>
                <ng-container *ngIf="locationAccuracy < 5 && locationAccuracy > 2">
                    <p style="margin: 0; color: orange">Mediocre<ion-icon name="help" style="margin-left: 2px"></ion-icon></p>
                </ng-container>
                <ng-container *ngIf="locationAccuracy > 4">
                    <p style="margin: 0; color: red">Mala<ion-icon name="close" style="margin-left: 2px"></ion-icon></p>
                </ng-container>
            </ion-list>
        </ion-item>
        <ion-item slot="end" lines="none">
            <ion-label>Awesome Label</ion-label>
        </ion-item>
    </ion-toolbar>
</ion-footer>

<ng-template #noDayDocument>
    <ion-col size="12">
        <ion-text color="primary" class="ion-text-center">
            <h1>Aun no has comenzado tu dia</h1>
        </ion-text>
    </ion-col>
</ng-template>